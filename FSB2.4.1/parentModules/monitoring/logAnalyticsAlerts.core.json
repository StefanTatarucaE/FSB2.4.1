{
  "alertRules": [
    {
      "alertName": "Example test alert",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE ACTIVITY",
      "alertSeverity": 2,
      "query": "AzureActivity|top 1 by TimeGenerated desc|summarize AggregatedValue=count() by bin(TimeGenerated,5m)|extend SubscriptionId=\"{SUBSCRIPTIONID}\"|project TimeGenerated,AggregatedValue,Caller=\"example-alert\",SubscriptionId,Resource_group=\"example-resource-group\",Resource_name=\"example-resource-001\"",
      "evaluationFrequency": "PT5M",
      "operator": "GreaterThan",
      "windowSize": "PT48H",
      "threshold": 0,
      "dimensionsName": "SubscriptionId",
      "timeAggregation": "Average",
      "metricMeasureColumn": "AggregatedValue",
      "enableAlert": false,
      "autoMitigate": false
    },
    {
      "alertName": "Azure Monitor alert disabled",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Security - Part of standard set of log alerts - Category AZURE MONITOR",
      "alertSeverity": 2,
      "query": "AzureActivity | where CategoryValue == \"Administrative\" and OperationNameValue == \"Microsoft.Insights/ScheduledQueryRules/disable/action\" | extend properties = parse_json(Properties) | project TimeGenerated, SubscriptionId, ResourceGroup, AlertName=split(_ResourceId, \"/\", 8)[0], Reason=properties.reason, ResourceID=_ResourceId",
      "evaluationFrequency": "PT1H",
      "operator": "GreaterThan",
      "windowSize": "PT1H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Create Automation Account",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 2,
      "query": "AzureActivity | where OperationNameValue == \"MICROSOFT.AUTOMATION/AUTOMATIONACCOUNTS/WRITE\" and ActivityStatusValue==\"Success\" and ActivitySubstatusValue==\"Created\" | where Claims_d.appid <> \"[parameter(callerAppId)]\" | extend p=parse_json(Properties) | project Caller=iif(isempty(Caller),\"(Automation Runbook)\",Caller),SubscriptionId,Resource_group=split(_ResourceId, \"/\",4)[0],Automation_account_name=p.resource,ResourceID=_ResourceId",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Delete Automation Account",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 1,
      "query": "AzureActivity | where OperationNameValue == \"MICROSOFT.AUTOMATION/AUTOMATIONACCOUNTS/DELETE\" and ActivityStatusValue==\"Success\" | extend p=parse_json(Properties) | summarize by CorrelationId, Caller, SubscriptionId, _ResourceId, Automation_account_name=tostring(p.resource) | project Caller=iif(isempty(Caller),\"(Automation Runbook)\",Caller), SubscriptionId,Resource_group=split(_ResourceId, \"/\",4)[0],Automation_account_name, ResourceID=_ResourceId",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Create Log Analytics Workspace",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 2,
      "query": "AzureActivity | where OperationNameValue == \"MICROSOFT.OPERATIONALINSIGHTS/WORKSPACES/WRITE\" and ActivityStatusValue==\"Success\" | extend p=parse_json(Properties) | project Caller=iif(isempty(Caller),\"(Automation Runbook)\",Caller), SubscriptionId,Resource_group=split(_ResourceId, \"/\",4)[0],Workspace_name=p.resource,ResourceID=_ResourceId",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Delete Log Analytics Workspace",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 0,
      "query": "AzureActivity | where OperationNameValue == \"MICROSOFT.OPERATIONALINSIGHTS/WORKSPACES/DELETE\" and ActivityStatusValue==\"Success\" | extend p=parse_json(Properties) | summarize by CorrelationId, Caller, SubscriptionId, _ResourceId, Workspace_name=tostring(p.resource) | project Caller=iif(isempty(Caller),\"(Automation Runbook)\",Caller), SubscriptionId,Resource_group=split(_ResourceId, \"/\",4)[0],Workspace_name, ResourceID=_ResourceId ",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Delete Policy Assignment",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category SUBSCRIPTION ALERT",
      "alertSeverity": 3,
      "query": "AzureActivity | where OperationNameValue contains \"Microsoft.Authorization/policyAssignments/delete\" | where ActivityStatusValue == \"Success\"| project TimeGenerated,TenantId,SubscriptionId=split(_ResourceId, \"/\", 2)[0],Policy_assignement_resourceId=_ResourceId,Caller=iif(isempty(Caller),\"(Automation Runbook)\",Caller),Level",
      "evaluationFrequency": "PT5M",
      "operator": "GreaterThan",
      "windowSize": "PT5M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Create or Update Policy Assignment",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category SUBSCRIPTION ALERT",
      "alertSeverity": 3,
      "query": "AzureActivity | where OperationNameValue contains \"Microsoft.Authorization/policyAssignments/write\" | where ActivityStatusValue == \"Success\" | where Claims_d.appid <> \"[parameter(callerAppId)]\" | project TimeGenerated,TenantId,SubscriptionId=split(_ResourceId, \"/\", 2)[0],Policy_assignement_resourceId=_ResourceId,Caller=iif(isempty(Caller),\"(Automation Runbook)\",Caller),Level,ResourceID=_ResourceId",
      "evaluationFrequency": "PT5M",
      "operator": "GreaterThan",
      "windowSize": "PT5M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Blob Storage - SuccessE2ELatency greater than threshold",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 1,
      "query": "AzureMetrics| where ResourceId contains \"/BLOBSERVICES/\" and MetricName == \"SuccessE2ELatency\"| project TimeGenerated,Latency_ms = round(Maximum, 1),SubscriptionId = tostring(split(_ResourceId, \"/\", 2)[0]),Resource_group = tostring(split(_ResourceId, \"/\", 4)[0]),SA_name = tostring(split(_ResourceId, \"/\", 8)[0]),ResourceID = tostring(split(tolower(_ResourceId), \"/blobservices/\", 0)[0]),alerthash=hash_md5(strcat(\"blobE2Elatency\", _ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "threshold": 500,
      "dimensionsName": "ResourceID",
      "timeAggregation": "Average",
      "metricMeasureColumn": "Latency_ms"
    },{
      "alertName": "Blob Storage - SuccessServerLatency greater than threshold",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 1,
      "query": "AzureMetrics| where ResourceId contains \"/BLOBSERVICES/\" and MetricName == \"SuccessServerLatency\"| project TimeGenerated,Latency_ms = round(Maximum, 1),SubscriptionId = tostring(split(_ResourceId, \"/\", 2)[0]),Resource_group=tostring(split(_ResourceId, \"/\", 4)[0]),SA_name=tostring(split(_ResourceId, \"/\", 8)[0]),ResourceID = tostring(split(tolower(_ResourceId), \"/blobservices/\", 0)[0]),alerthash=hash_md5(strcat(\"blobserverlatency\", _ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "threshold": 500,
      "dimensionsName": "ResourceID",
      "timeAggregation": "Average",
      "metricMeasureColumn": "Latency_ms"
    },
    {
      "alertName": "Blob Storage - Throttling error",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 2,
      "query": "StorageBlobLogs | where StatusCode == 503 | summarize AggregatedValue=count(StatusCode) by _ResourceId, OperationName, StatusText, bin(TimeGenerated, 30m) | project TimeGenerated,SubscriptionID=split(_ResourceId, \"/\", 2)[0],Resource_group=split(_ResourceId, \"/\", 4)[0],SA_name=split(_ResourceId, \"/\", 8)[0],ResourceID = split(tolower(_ResourceId), \"/blobservices/\", 0)[0],OperationName,StatusText,RequestsThrottling = AggregatedValue,AggregatedValue,alerthash=hash_md5(strcat(\"blobthrottling\", _ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "timeAggregation": "Count",
      "threshold": 100,
      "metricColumn": "ResourceID",
      "metricThresholdOperator": "GreaterThan",
      "metricThreshold": 0,
      "enableAlert": false,
      "metricTriggerType": "Consecutive"
    },
    {
      "alertName": "Blob Storage - Time Out error",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 1,
      "query": "StorageBlobLogs | where StatusCode == 500| summarize RequestsTimedOut=count(StatusCode) by _ResourceId, OperationName, StatusText | project SubscriptionID=split(_ResourceId, \"/\",2)[0],Resource_group=split(_ResourceId, \"/\",4)[0],SA_name=split(_ResourceId, \"/\",8)[0], ResourceID = split(tolower(_ResourceId), \"/blobservices/\", 0)[0], OperationName, StatusText, RequestsTimedOut, alerthash=hash_md5(strcat(\"blobtimeout\",_ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "timeAggregation": "Count",
      "metricColumn": "ResourceID",
      "metricThresholdOperator": "GreaterThan",
      "metricThreshold": 3,
      "metricTriggerType": "Consecutive",
      "enableAlert": false,
      "threshold": 1000
    },
    {
      "alertName": "Blob Storage - Availability less than 99 percent",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 0,
      "query": "AzureMetrics| where ResourceId contains \"/BLOBSERVICES/\" and MetricName == \"Availability\"| project TimeGenerated,Availability_percentage = round(Minimum, 1), SubscriptionId = tostring(split(_ResourceId, \"/\", 2)[0]),Resource_group = tostring(split(_ResourceId, \"/\", 4)[0]),SA_name = tostring(split(_ResourceId, \"/\", 8)[0]),ResourceID = tostring(split(tolower(_ResourceId), \"/blobservices/\", 0)[0]),alerthash = hash_md5(strcat(\"blobavailability\", _ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "LessThan",
      "windowSize": "PT30M",
      "threshold": 99,
      "dimensionsName": "ResourceID",
      "timeAggregation": "Average",
      "metricMeasureColumn": "Availability_percentage"
    },
    {
      "alertName": "File Storage - SuccessE2ELatency greater than threshold",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 2,
      "query": "AzureMetrics| where ResourceId contains \"/FILESERVICES/\" and MetricName == \"SuccessE2ELatency\"| summarize AggregatedValue = avg(Maximum) by _ResourceId, bin(TimeGenerated, 30m)| project TimeGenerated,Latency_ms=round(AggregatedValue, 1),AggregatedValue=round(AggregatedValue, 1),SubscriptionId=split(_ResourceId, \"/\", 2)[0],Resource_group=split(_ResourceId, \"/\", 4)[0],SA_name=tostring(split(_ResourceId, \"/\", 8)[0]),ResourceID = tostring(split(tolower(_ResourceId), \"/fileservices/\", 0)[0]),alerthash=hash_md5(strcat(\"fileE2Elatency\", _ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "threshold": 500,
      "dimensionsName": "ResourceID",
      "timeAggregation": "Average",
      "metricMeasureColumn": "AggregatedValue"
    },
    {
      "alertName": "File Storage - SuccessServerLatency greater than threshold",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 2,
      "query": "AzureMetrics| where ResourceId contains \"/FILESERVICES/\" and MetricName == \"SuccessServerLatency\"| summarize AggregatedValue = avg(Maximum) by _ResourceId, bin(TimeGenerated, 30m)| project TimeGenerated,Latency_ms=round(AggregatedValue, 1),AggregatedValue=round(AggregatedValue, 1),SubscriptionId=split(_ResourceId, \"/\", 2)[0],Resource_group=split(_ResourceId, \"/\", 4)[0],SA_name=tostring(split(_ResourceId, \"/\", 8)[0]),ResourceID = tostring(split(tolower(_ResourceId), \"/fileservices/\", 0)[0]),alerthash=hash_md5(strcat(\"fileserverlatency\", _ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "threshold": 500,
      "dimensionsName": "ResourceID",
      "timeAggregation": "Average",
      "metricMeasureColumn": "AggregatedValue"
    },
    {
      "alertName": "File Storage - Throttling error",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 2,
      "query": "StorageFileLogs | where StatusCode == 503 | summarize RequestsThrottling=count(StatusCode) by _ResourceId, OperationName, StatusText | project SubscriptionID=split(_ResourceId, \"/\",2)[0],Resource_group=split(_ResourceId, \"/\",4)[0],SA_name=split(_ResourceId, \"/\",8)[0], ResourceID = split(tolower(_ResourceId), \"/fileservices/\", 0)[0], OperationName, StatusText, RequestsThrottling, alerthash=hash_md5(strcat(\"filethrottling\",_ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "File Storage - Time Out error",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 2,
      "query": "StorageFileLogs | where StatusCode == 500| summarize RequestsTimedOut=count(StatusCode) by _ResourceId, OperationName, StatusText | project SubscriptionID=split(_ResourceId, \"/\",2)[0],Resource_group=split(_ResourceId, \"/\",4)[0],SA_name=split(_ResourceId, \"/\",8)[0], ResourceID = split(tolower(_ResourceId), \"/fileservices/\", 0)[0], OperationName, StatusText, RequestsTimedOut, alerthash=hash_md5(strcat(\"filetimeout\",_ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "File Storage - Availability less than 99 percent",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 2,
      "query": "AzureMetrics| where ResourceId contains \"/FILESERVICES/\" and MetricName == \"Availability\"| project TimeGenerated,Availability_percentage=round(Minimum, 1),SubscriptionId=tostring(split(_ResourceId, \"/\", 2)[0]),Resource_group=tostring(split(_ResourceId, \"/\", 4)[0]),SA_name=tostring(split(_ResourceId, \"/\", 8)[0]),ResourceID = tostring(split(tolower(_ResourceId), \"/fileservices/\", 0)[0]),alerthash=hash_md5(strcat(\"fileavailability\", _ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "LessThan",
      "windowSize": "PT30M",
      "threshold": 99,
      "dimensionsName": "ResourceID",
      "timeAggregation": "Average",
      "metricMeasureColumn": "Availability_percentage"
    },
    {
      "alertName": "File Storage - SMB Error",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 2,
      "query": "StorageFileLogs | where Protocol == \"SMB\" and StatusCode contains \"-\"| summarize AggregatedValue=count(StatusCode) by _ResourceId, OperationName, StatusText, bin(TimeGenerated, 30m) | project TimeGenerated, SubscriptionID=split(_ResourceId, \"/\",2)[0],Resource_group=split(_ResourceId, \"/\",4)[0],SA_name=split(_ResourceId, \"/\",8)[0], ResourceID= tostring(split(tolower(_ResourceId), \"/fileservices/\", 0)[0]), OperationName, StatusText, SMBErrors=round(AggregatedValue, 1),AggregatedValue=round(AggregatedValue, 1), alerthash=hash_md5(strcat(\"SMBError\",_ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "threshold": 1000,
      "dimensionsName": "ResourceID",
      "metricThreshold": 3,
      "timeAggregation": "Average",
      "metricMeasureColumn": "AggregatedValue",
      "metricTriggerType": "Consecutive"
    },
    {
      "alertName": "Queue Storage - SuccessE2ELatency greater than threshold",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 2,
      "query": "AzureMetrics| where ResourceId contains \"/QUEUESERVICES/\" and MetricName == \"SuccessE2ELatency\"| summarize AggregatedValue = avg(Maximum) by _ResourceId, bin(TimeGenerated, 30m)| project TimeGenerated,Latency_ms=round(AggregatedValue, 1),AggregatedValue=round(AggregatedValue, 1),SubscriptionId=split(_ResourceId, \"/\", 2)[0],Resource_group=split(_ResourceId, \"/\", 4)[0],SA_name=tostring(split(_ResourceId, \"/\", 8)[0]),ResourceID = tostring(split(tolower(_ResourceId), \"/queueservices/\", 0)[0]),alerthash=hash_md5(strcat(\"queueE2Elatency\", _ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "threshold": 500,
      "dimensionsName": "ResourceID",
      "timeAggregation": "Average",
      "metricMeasureColumn": "AggregatedValue"
    },
    {
      "alertName": "Queue Storage - SuccessServerLatency greater than threshold",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 2,
      "query": "AzureMetrics| where ResourceId contains \"/QUEUESERVICES/\" and MetricName == \"SuccessServerLatency\"| summarize AggregatedValue = avg(Maximum) by _ResourceId, bin(TimeGenerated, 30m)| project TimeGenerated,Latency_ms=round(AggregatedValue, 1),AggregatedValue=round(AggregatedValue, 1),SubscriptionId=split(_ResourceId, \"/\", 2)[0],Resource_group=split(_ResourceId, \"/\", 4)[0],SA_name=tostring(split(_ResourceId, \"/\", 8)[0]),ResourceID = tostring(split(tolower(_ResourceId), \"/queueservices/\", 0)[0]),alerthash=hash_md5(strcat(\"queueserverlatency\", _ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "threshold": 500,
      "dimensionsName": "ResourceID",
      "timeAggregation": "Average",
      "metricMeasureColumn": "AggregatedValue"
    },
    {
      "alertName": "Queue Storage - Throttling error",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 2,
      "query": "StorageQueueLogs | where StatusCode == 503 | summarize RequestsThrottling=count(StatusCode) by _ResourceId, OperationName, StatusText | project SubscriptionID=split(_ResourceId, \"/\",2)[0],Resource_group=split(_ResourceId, \"/\",4)[0],SA_name=split(_ResourceId, \"/\",8)[0], ResourceID = split(tolower(_ResourceId), \"/queueservices/\", 0)[0], OperationName, StatusText, RequestsThrottling, alerthash=hash_md5(strcat(\"queuethrottling\",_ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Queue Storage - Time Out error",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 2,
      "query": "StorageQueueLogs | where StatusCode == 500| summarize RequestsTimedOut=count(StatusCode) by _ResourceId, OperationName, StatusText | project SubscriptionID=split(_ResourceId, \"/\",2)[0],Resource_group=split(_ResourceId, \"/\",4)[0],SA_name=split(_ResourceId, \"/\",8)[0], ResourceID = split(tolower(_ResourceId), \"/queueservices/\", 0)[0], OperationName, StatusText, RequestsTimedOut, alerthash=hash_md5(strcat(\"queuetimeout\",_ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Queue Storage - Availability less than 99 percent",
      "alertDescription": "Cloud.IaaS.DCS-Azure-Storage - Part of standard set of log alerts - Category AZURE RESOURCES",
      "alertSeverity": 2,
      "query": "AzureMetrics| where ResourceId contains \"/QUEUESERVICES/\" and MetricName == \"Availability\"| summarize AggregatedValue = avg(Minimum) by _ResourceId, bin(TimeGenerated, 30m) | project TimeGenerated,Availability_percentage=round(AggregatedValue, 1),AggregatedValue=round(AggregatedValue, 1),SubscriptionId=split(_ResourceId, \"/\", 2)[0],Resource_group=split(_ResourceId, \"/\", 4)[0],SA_name=tostring(split(_ResourceId, \"/\", 8)[0]),ResourceID = tostring(split(tolower(_ResourceId), \"/queueservices/\", 0)[0]),alerthash=hash_md5(strcat(\"queueavailability\", _ResourceId))",
      "evaluationFrequency": "PT30M",
      "operator": "LessThan",
      "windowSize": "PT30M",
      "threshold": 99,
      "dimensionsName": "ResourceID",
      "timeAggregation": "Average",
      "metricMeasureColumn": "AggregatedValue"
    },
    {
      "alertName": "Monitor failed Azure automation jobs",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE ACTIVITY",
      "alertSeverity": 2,
      "query": "AzureDiagnostics | where ResourceProvider == \"MICROSOFT.AUTOMATION\" and Category==\"JobLogs\" and OperationName==\"Job\" and ResultType==\"Failed\" and RunbookName_s<>\"Patch-MicrosoftOMSComputer\" | project SubscriptionId, Resource_group=split(_ResourceId, \"/\",4)[0], Automation_account_name=Resource, Runbook_name=RunbookName_s",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "User login failed 5 Attempts with same user account",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Security - Part of standard set of log alerts - Category AZURE ACTIVE DIRECTORY",
      "alertSeverity": 0,
      "query": "SigninLogs | where ResultDescription contains \"Invalid username or password\" | summarize UserCount=count() by Identity,ResultDescription | where UserCount > 4 | project Description=ResultDescription, Account_name=Identity",
      "evaluationFrequency": "PT15M",
      "operator": "GreaterThan",
      "windowSize": "PT15M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Add direct member to Subscription Owner role",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Security - Part of standard set of log alerts - Category AZURE AD RESOURCES",
      "alertSeverity": 2,
      "query": "AzureActivity | where CategoryValue =~ \"Administrative\" and OperationNameValue =~ \"Microsoft.Authorization/roleAssignments/write\" and (ActivityStatusValue =~ \"Start\" or ActivityStatus =~ \"Started\") | extend RoleDefinition = extractjson(\"$.Properties.RoleDefinitionId\",tostring(Properties_d.requestbody),typeof(string)) | extend PrincipalId = extractjson(\"$.Properties.PrincipalId\",tostring(Properties_d.requestbody),typeof(string)) | extend PrincipalType = extractjson(\"$.Properties.PrincipalType\",tostring(Properties_d.requestbody),typeof(string)) | extend Scope = extractjson(\"$.Properties.Scope\",tostring(Properties_d.requestbody),typeof(string)) | where Scope !contains \"resourcegroups\" | extend RoleId = split(RoleDefinition,'/')[-1] | extend RoleDisplayName = case(RoleId =~ '8e3af657-a8ff-443c-a75c-2fe8c4bcb635', \"Owner\", \"Irrelevant\") | where RoleDisplayName != \"Irrelevant\" | project TimeGenerated, TenantId, SubscriptionId, Scope, PrincipalId,PrincipalType,RoleDisplayName, Caller, CallerIpAddress",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Add member to Subscription Owner group",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Security - Part of standard set of log alerts - Category AZURE AD RESOURCES",
      "alertSeverity": 2,
      "query": "AuditLogs | where OperationName == \"Add member to group\" | where ((TargetResources contains \"-owner\") or (TargetResources contains \"-subscriptionowner\")) | extend c = parse_json (InitiatedBy) | extend Caller = c.user.userPrincipalName | extend a = parse_json(TargetResources) | extend Account_added_to_group = a.displayName | project Caller=Caller,Group_name=replace('\"','',tostring(a[0].modifiedProperties[1].newValue)),Account_added_to_group=a[0].userPrincipalName",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Add member to limited Administrator role Security Administrator (Directory)",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Security - Part of standard set of log alerts - Category AZURE AD RESOURCES",
      "alertSeverity": 2,
      "query": "AuditLogs | where OperationName == \"Add member to role\" | where TargetResources contains \"Security Administrator\" | extend c = parse_json (InitiatedBy) | extend Caller = c.user.userPrincipalName | extend a = parse_json(TargetResources) | mvexpand a | extend Account_added_to_role = a.userPrincipalName | where Account_added_to_role contains \"@\" | project Caller=Caller,Role_name=\"Security Administrator\",Account_added_to_role=Account_added_to_role",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Add member to global Administrator role (Directory)",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Security - Part of standard set of log alerts - Category AZURE AD RESOURCES",
      "alertSeverity": 2,
      "query": "AuditLogs | where OperationName == \"Add member to role\" | where TargetResources contains \"62e90394-69f5-4237-9190-012177145e10\" | extend c = parse_json (InitiatedBy) | extend Caller = c.user.userPrincipalName | extend a = parse_json(TargetResources) | mvexpand a | extend Account_added_to_role = a.userPrincipalName | where Account_added_to_role contains \"@\" | project Caller=Caller,Role_name=\"Global Administrator\",Account_added_to_role=Account_added_to_role",
      "evaluationFrequency": "PT30M",
      "operator": "GreaterThan",
      "windowSize": "PT30M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "User login failed 5 Attempts with same IP address",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Security - Part of standard set of log alerts - Category AZURE ACTIVE DIRECTORY",
      "alertSeverity": 0,
      "query": "SigninLogs | where ResultDescription contains \"Invalid username or password\" | summarize IPCount=count() by IPAddress,ResultDescription | where IPCount > 4 | project Description=ResultDescription, Client_IP_address=IPAddress",
      "evaluationFrequency": "PT15M",
      "operator": "GreaterThan",
      "windowSize": "PT15M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "New critical Security Center Alert",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Security - Part of standard set of log alerts - Category SECURITY CENTER",
      "alertSeverity": 1,
      "query": "SecurityAlert | where AlertSeverity == \"High\" and TimeGenerated > ago(1h) | project Alert_name=DisplayName, Description, Product_name=ProductName, Severity=AlertSeverity,ResourceID=ResourceId,alerthash=hash_md5(strcat(\"scalert\",ResourceId))",
      "evaluationFrequency": "PT15M",
      "operator": "GreaterThan",
      "windowSize": "PT15M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "New critical Security Recommendation",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Security - Part of standard set of log alerts - Category SECURITY CENTER",
      "alertSeverity": 0,
      "query": "SecurityRecommendation | where RecommendationSeverity == \"High\" and RecommendationState==\"Unhealthy\" and TimeGenerated > ago(1h) | project Recommendation_name=RecommendationDisplayName, Description, Severity=RecommendationSeverity, Additional_data=RecommendationAdditionalData,ResourceID=AssessedResourceId,alerthash=hash_md5(strcat(\"secrecom\",AssessedResourceId))",
      "evaluationFrequency": "PT15M",
      "operator": "GreaterThan",
      "windowSize": "PT15M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Create or Update Security Solution",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category SUBSCRIPTION ALERT",
      "alertSeverity": 3,
      "query": "AzureActivity | where OperationNameValue == \"Microsoft.Security/locations/securitySolutions/write\" | where ActivityStatusValue == \"Success\"| project TimeGenerated,TenantId,SubscriptionId=split(_ResourceId, \"/\", 2)[0],Scope=split(Authorization, \"\\\"scope\\\":\")[1],Security_solution_resourceId=_ResourceId,Caller=iif(isempty(Caller),\"(Automation Runbook)\",Caller),Level,ResourceID=_ResourceId",
      "evaluationFrequency": "PT5M",
      "operator": "GreaterThan",
      "windowSize": "PT5M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Delete Security Solution",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category SUBSCRIPTION ALERT",
      "alertSeverity": 3,
      "query": "AzureActivity | where OperationNameValue == \"Microsoft.Security/locations/securitySolutions/delete\" | where ActivityStatusValue == \"Success\"| project TimeGenerated,TenantId,SubscriptionId=split(_ResourceId, \"/\", 2)[0],Scope=split(Authorization, \"\\\"scope\\\":\")[1],Security_solution_resourceId=_ResourceId,Caller=iif(isempty(Caller),\"(Automation Runbook)\",Caller),Level",
      "evaluationFrequency": "PT5M",
      "operator": "GreaterThan",
      "windowSize": "PT5M",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc Total Regional vCPUs",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"Total Regional vCPUs\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category=Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc Total Regional vCPUs",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"Total Regional vCPUs\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },    
    {
      "alertName": "Service Limit at 100 perc Virtual Machines",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"Virtual Machines\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },    
    {
      "alertName": "Service Limit gt 80 perc Virtual Machines",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"Virtual Machines\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc Virtual Machine Scale Sets",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"Virtual Machine Scale Sets\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc Virtual Machine Scale Sets",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"Virtual Machine Scale Sets\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc Standard Storage Managed Disks",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"Standard Storage Managed Disks\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc Standard Storage Managed Disks",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"Standard Storage Managed Disks\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc Premium Storage Managed Disks",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"Premium Storage Managed Disks\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    }, 
    {
      "alertName": "Service Limit gt 80 perc Premium Storage Managed Disks",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"Premium Storage Managed Disks\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc StandardSSDStorageDisks",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"StandardSSDStorageDisks\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc StandardSSDStorageDisks",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"StandardSSDStorageDisks\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc StandardStorageSnapshots",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"StandardStorageSnapshots\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc StandardStorageSnapshots",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"StandardStorageSnapshots\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc PremiumStorageSnapshots",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"PremiumStorageSnapshots\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc PremiumStorageSnapshots",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"PremiumStorageSnapshots\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc ZrsStorageSnapshots",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"ZrsStorageSnapshots\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc ZrsStorageSnapshots",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"ZrsStorageSnapshots\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc Storage Accounts",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"Storage Accounts\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc Storage Accounts",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"Storage Accounts\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc Virtual Networks",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"Virtual Networks\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc Virtual Networks",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"Virtual Networks\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc Static Public IP Addresses",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"Static Public IP Addresses\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc Static Public IP Addresses",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"Static Public IP Addresses\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc Network Security Groups",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"Network Security Groups\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc Network Security Groups",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"Network Security Groups\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc Security rules per NSG",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"Security rules per Network Security Group\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc Security rules per NSG",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"Security rules per Network Security Group\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc Security rules addresses or ports per NSG",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"Security rules addresses or ports per Network Security Group\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc Security rules addresses or ports per NSG",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"Security rules addresses or ports per Network Security Group\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc Public IP Addresses",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"Public IP Addresses\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc Public IP Addresses",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"Public IP Addresses\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc Network Interfaces",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"Network Interfaces\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    }, 
    {
      "alertName": "Service Limit gt 80 perc Network Interfaces",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"Network Interfaces\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc Load Balancers",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"Load Balancers\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc Load Balancers",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"Load Balancers\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit at 100 perc Application Gateways",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 1,
      "query": "AzureQuota_CL | where Name_s == \"Application Gateways\" | where CurrentValue_d == Limit_d | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100), alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,\"Service Limit at 100 perc\"))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    },
    {
      "alertName": "Service Limit gt 80 perc Application Gateways",
      "alertDescription": "Cloud.PaaS.DCS-Azure-Management - Part of standard set of log alerts - Category AZURE LIMITS",
      "alertSeverity": 2,
      "query": "AzureQuota_CL | where Name_s == \"Application Gateways\" | where ((CurrentValue_d / Limit_d *100) >= 80) and ((CurrentValue_d / Limit_d *100) < 100) | project SubscriptionID=SubscriptionId, Subscription_name=SubscriptionName_s, Location=Location_s, Category, Current_value=CurrentValue_d, Azure_limit=Limit_d, Usage_percent=(Usage_d*100),alerthash=hash_md5(strcat(Name_s,SubscriptionId,SubscriptionName_s,Location_s,Category,Limit_d))",
      "evaluationFrequency": "PT3H",
      "operator": "GreaterThan",
      "windowSize": "PT6H",
      "timeAggregation": "Count",
      "threshold": 0
    }
  ]
}